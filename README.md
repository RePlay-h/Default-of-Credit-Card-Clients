# Default of Credit Card Clients

–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ—à–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–µ—Ñ–æ–ª—Ç–∞ –¥–µ—Ä–∂–∞—Ç–µ–ª–µ–π –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –∫–∞—Ä—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö –±–∞–Ω–∫–æ–≤ –¢–∞–π–≤–∞–Ω—è.  
–î–∞–Ω–Ω—ã–µ –≤–∑—è—Ç—ã —Å [UCI Machine Learning Repository](https://archive.ics.uci.edu/dataset/350/default+of+credit+card+clients).  

–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–∞ –≤–∞–∂–Ω–æ –¥–ª—è –±–∞–Ω–∫–æ–≤, —Ç–∞–∫ –∫–∞–∫ –ø–æ–º–æ–≥–∞–µ—Ç —Å–Ω–∏–∂–∞—Ç—å –∫—Ä–µ–¥–∏—Ç–Ω—ã–µ —Ä–∏—Å–∫–∏, –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–∏–º–∏—Ç—ã –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–¥–∞—á—É –∫—Ä–µ–¥–∏—Ç–æ–≤.  

---

## üìä –î–∞—Ç–∞—Å–µ—Ç

–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ **30 000 –∫–ª–∏–µ–Ω—Ç–∞—Ö**, –≤–∫–ª—é—á–∞—è:  
- –∫—Ä–µ–¥–∏—Ç–Ω—ã–π –ª–∏–º–∏—Ç (LIMIT_BAL),  
- –ø–æ–ª, –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, —Å–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ, –≤–æ–∑—Ä–∞—Å—Ç,  
- –∏—Å—Ç–æ—Ä–∏—é –ø–ª–∞—Ç–µ–∂–µ–π –∑–∞ 6 –º–µ—Å—è—Ü–µ–≤ (PAY_0 ‚Ä¶ PAY_6),  
- –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –ø–æ —Å—á–µ—Ç–∞–º (BILL_AMT1 ‚Ä¶ BILL_AMT6),  
- —Å—É–º–º—É –ø–ª–∞—Ç–µ–∂–µ–π (PAY_AMT1 ‚Ä¶ PAY_AMT6),  
- —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é default_payment_next_month ‚Äî —Ñ–∞–∫—Ç –¥–µ—Ñ–æ–ª—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –º–µ—Å—è—Ü–µ.  

–ö–ª–∞—Å—Å —Å–∏–ª—å–Ω–æ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω (–æ–∫–æ–ª–æ 22% –¥–µ—Ñ–æ–ª—Ç–æ–≤), –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ —É—á–∏—Ç—ã–≤–∞–ª–∞—Å—å —Ä–∞–±–æ—Ç–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º.  

---

## üõ†Ô∏è –§–∏—á–µ–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥

–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:

1. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å—Ä–æ—á–µ–∫**  
   –°—É–º–º–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (PAY_i > 0) –ø–æ –≤—Å–µ–º –º–µ—Å—è—Ü–∞–º.  

2. **Debt ratio**  
   –û—Ç–Ω–æ—à–µ–Ω–∏–µ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ –∫ –∫—Ä–µ–¥–∏—Ç–Ω–æ–º—É –ª–∏–º–∏—Ç—É:  
   
   $\text{debt\_ratio} = \frac{\text{BILL\_AMT}}{\text{LIMIT\_BAL}}$
   

3. **Payment ratio**  
   –û—Ç–Ω–æ—à–µ–Ω–∏–µ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ–∏–∑–≤–µ–¥—ë–Ω–Ω–æ–º—É –ø–ª–∞—Ç–µ–∂—É:  
   
   $\text{payment\_ratio} = \frac{\text{BILL\_AMT}}{\text{PAY\_AMT}}$


---

## ü§ñ –ú–æ–¥–µ–ª–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏

- **Logistic Regression** ‚Äî –±–µ–π–∑–ª–∞–π–Ω.  
- **CatBoostClassifier** ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å, –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–±–∏—Ä–∞–ª–∏—Å—å —Å –ø–æ–º–æ—â—å—é Optuna (–∞–ª–≥–æ—Ä–∏—Ç–º TPE).  

–û—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ ‚Äî **AUC ROC**, —Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏–∑–º–µ—Ä—è–ª–∏—Å—å precision, recall –∏ f1-score.  

### Logistic Regression
- AUC: `0.6396`  
- Precision: `0.0` 
- Recall: `0.0`  
- F1: `0.0`  

Confusion matrix:
```
[[7056 2]
[1942 0]]
```

### CatBoost
- AUC: `0.7801`  
- Precision: `0.6877`  
- Recall: `0.3584`  
- F1: `0.4712`  

Confusion matrix:
```
[[6742 316]
[1246 696]]
```

üìå CatBoost –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤–∑–æ—à—ë–ª Logistic Regression –∏ –ø–æ–∫–∞–∑–∞–ª –±–æ–ª–µ–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è precision –∏ recall.  

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
‚îú‚îÄ‚îÄ .dvc/ # —Å–ª—É–∂–µ–±–Ω—ã–µ —Ñ–∞–π–ª—ã DVC
‚îú‚îÄ‚îÄ catboost_info/ # —Å–ª—É–∂–µ–±–Ω—ã–µ —Ñ–∞–π–ª—ã CatBoost
‚îú‚îÄ‚îÄ data/ # –¥–∞–Ω–Ω—ã–µ
‚îÇ ‚îú‚îÄ‚îÄ raw/ # –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ clients.xls
‚îÇ ‚îú‚îÄ‚îÄ processed/ # –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ data.csv
‚îÇ ‚îî‚îÄ‚îÄ test/ # –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ ‚îú‚îÄ‚îÄ X_test.csv
‚îÇ ‚îî‚îÄ‚îÄ y_test.csv
‚îú‚îÄ‚îÄ env/ # –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ metrics/ # –º–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–µ–π
‚îÇ ‚îî‚îÄ‚îÄ metrics.json
‚îú‚îÄ‚îÄ model/ # —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ ‚îú‚îÄ‚îÄ baseline.pkl # Logistic Regression
‚îÇ ‚îî‚îÄ‚îÄ boosting.pkl # CatBoost
‚îú‚îÄ‚îÄ src/ # –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ ‚îú‚îÄ‚îÄ preprocess.py # –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö
‚îÇ ‚îú‚îÄ‚îÄ train.py # –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
‚îÇ ‚îî‚îÄ‚îÄ test.py # –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ EDA.ipynb # —Ä–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ params.yaml # –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ dvc.yaml # –ø–∞–π–ø–ª–∞–π–Ω DVC
‚îú‚îÄ‚îÄ dvc.lock # lock-—Ñ–∞–π–ª DVC
‚îú‚îÄ‚îÄ requirements.txt # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md # –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```
## ‚úÖ –í—ã–≤–æ–¥—ã

- Logistic Regression –ø–ª–æ—Ö–æ —Å–ø—Ä–∞–≤–∏–ª–∞—Å—å —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤ –∏ –ø–æ—á—Ç–∏ –Ω–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–ª–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å.  
- CatBoost –¥–∞–ª –æ—â—É—Ç–∏–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç (AUC ‚âà 0.78) –∏ –ª—É—á—à–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–ª precision –∏ recall.  
- –í –±—É–¥—É—â–µ–º –º–æ–¥–µ–ª—å –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –∑–∞ —Å—á—ë—Ç:
  - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è **PR AUC** –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏,  
  - –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∫–ª–∞—Å—Å–æ–≤ (SMOTE, undersampling, scale_pos_weight),  
  